# run legacy:
fixelcfestats fixelfilter/smooth/out/ fixelcfestats/subjects.txt fixelcfestats/design.txt -ttests fixelcfestats/contrast.txt SIFT_phantom/matrix/ tmp_legacy -cfe_legacy -force
# check outputs:
( for f in abs_effect beta0 beta1 std_dev std_effect tvalue; do testing_diff_image tmp_legacy/$f.mif fixelcfestats/legacy/$f.mif -abs 1e-6 || exit 1; done ) && mrcalc tmp_legacy/fwe_1mpvalue.mif 0.95 -gt - | testing_diff_image - SIFT_phantom/fixels/upper.mif

# run default:
fixelcfestats fixelfilter/smooth/out/ fixelcfestats/subjects.txt fixelcfestats/design.txt -ttests fixelcfestats/contrast.txt SIFT_phantom/matrix/ tmp_default/ -force
# check outputs:
( for f in abs_effect beta0 beta1 cfe std_dev std_effect tvalue Zstat; do testing_diff_image tmp_default/$f.mif fixelcfestats/default/$f.mif -abs 1e-6 || exit 1; done ) && mrcalc tmp_default/fwe_1mpvalue.mif 0.95 -gt - | testing_diff_image - SIFT_phantom/fixels/upper.mif

# run masked:
fixelcfestats fixelfilter/smooth/out/ fixelcfestats/subjects.txt fixelcfestats/design.txt -ttests fixelcfestats/contrast.txt SIFT_phantom/matrix/ tmp_masked/ -mask SIFT_phantom/fixels/upper.mif -force
# check outputs:
( for f in abs_effect beta0 beta1 cfe std_dev std_effect tvalue Zstat; do testing_diff_image tmp_masked/$f.mif fixelcfestats/masked/$f.mif -abs 1e-6 || exit 1; done ) && mrcalc tmp_masked/fwe_1mpvalue.mif 0.95 -gt - | testing_diff_image - SIFT_phantom/fixels/upper.mif

# run posthoc analysis:
fixelcfestats fixelfilter/smooth/out/ fixelcfestats/subjects.txt fixelcfestats/design.txt -ttests fixelcfestats/contrast.txt SIFT_phantom/matrix/ tmp_posthoc/ -posthoc fixelcfestats/posthoc.mif
# check outputs:
( for f in abs_effect beta0 beta1 std_dev std_effect tvalue; do testing_diff_image tmp_posthoc/$f.mif fixelcfestats/posthoc/$f.mif -abs 1e-6 || exit 1; done ) && mrcalc tmp_posthoc/fwe_1mpvalue.mif 0.95 -gt - | testing_diff_image - fixelcfestats/posthoc.mif
